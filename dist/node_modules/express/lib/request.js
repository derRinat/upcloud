function defineGetter(e,t,n){Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:n})}var accepts=require("accepts"),deprecate=require("depd")("express"),isIP=require("net").isIP,typeis=require("type-is"),http=require("http"),fresh=require("fresh"),parseRange=require("range-parser"),parse=require("parseurl"),proxyaddr=require("proxy-addr"),req=exports=module.exports={__proto__:http.IncomingMessage.prototype};req.get=req.header=function(e){switch(e=e.toLowerCase()){case"referer":case"referrer":return this.headers.referrer||this.headers.referer;default:return this.headers[e]}},req.accepts=function(){var e=accepts(this);return e.types.apply(e,arguments)},req.acceptsEncodings=function(){var e=accepts(this);return e.encodings.apply(e,arguments)},req.acceptsEncoding=deprecate.function(req.acceptsEncodings,"req.acceptsEncoding: Use acceptsEncodings instead"),req.acceptsCharsets=function(){var e=accepts(this);return e.charsets.apply(e,arguments)},req.acceptsCharset=deprecate.function(req.acceptsCharsets,"req.acceptsCharset: Use acceptsCharsets instead"),req.acceptsLanguages=function(){var e=accepts(this);return e.languages.apply(e,arguments)},req.acceptsLanguage=deprecate.function(req.acceptsLanguages,"req.acceptsLanguage: Use acceptsLanguages instead"),req.range=function(e){var t=this.get("Range");if(!t)return;return parseRange(e,t)},req.param=function(e,t){var n=this.params||{},r=this.body||{},i=this.query||{};return null!=n[e]&&n.hasOwnProperty(e)?n[e]:null!=r[e]?r[e]:null!=i[e]?i[e]:t},req.is=function(e){return Array.isArray(e)||(e=[].slice.call(arguments)),typeis(this,e)},defineGetter(req,"protocol",function(){var t=this.connection.encrypted?"https":"http",n=this.app.get("trust proxy fn");return n(this.connection.remoteAddress)?(t=this.get("X-Forwarded-Proto")||t,t.split(/\s*,\s*/)[0]):t}),defineGetter(req,"secure",function(){return"https"==this.protocol}),defineGetter(req,"ip",function(){var t=this.app.get("trust proxy fn");return proxyaddr(this,t)}),defineGetter(req,"ips",function(){var t=this.app.get("trust proxy fn"),n=proxyaddr.all(this,t);return n.slice(1).reverse()}),defineGetter(req,"subdomains",function e(){var t=this.hostname;if(!t)return[];var n=this.app.get("subdomain offset"),e=isIP(t)?[t]:t.split(".").reverse();return e.slice(n)}),defineGetter(req,"path",function(){return parse(this).pathname}),defineGetter(req,"hostname",function(){var t=this.app.get("trust proxy fn"),n=this.get("X-Forwarded-Host");if(!n||!t(this.connection.remoteAddress))n=this.get("Host");if(!n)return;var r=n[0]==="["?n.indexOf("]")+1:0,i=n.indexOf(":",r);return~i?n.substring(0,i):n}),defineGetter(req,"host",deprecate.function(function(){return this.hostname},"req.host: Use req.hostname instead")),defineGetter(req,"fresh",function(){var e=this.method,t=this.res.statusCode;return"GET"!=e&&"HEAD"!=e?!1:t>=200&&t<300||304==t?fresh(this.headers,this.res._headers):!1}),defineGetter(req,"stale",function(){return!this.fresh}),defineGetter(req,"xhr",function(){var t=this.get("X-Requested-With")||"";return"xmlhttprequest"==t.toLowerCase()});