function acceptParams(e,t){var n=e.split(/ *; */),r={value:n[0],quality:1,params:{},originalIndex:t};for(var i=1;i<n.length;++i){var s=n[i].split(/ *= */);"q"==s[0]?r.quality=parseFloat(s[1]):r.params[s[0]]=s[1]}return r}function newObject(){return{}}var contentDisposition=require("content-disposition"),deprecate=require("depd")("express"),mime=require("send").mime,basename=require("path").basename,etag=require("etag"),proxyaddr=require("proxy-addr"),qs=require("qs"),querystring=require("querystring"),typer=require("media-typer");exports.etag=function(e,t){var n=Buffer.isBuffer(e)?e:new Buffer(e,t);return etag(n,{weak:!1})},exports.wetag=function(t,n){var r=Buffer.isBuffer(t)?t:new Buffer(t,n);return etag(r,{weak:!0})},exports.isAbsolute=function(e){if("/"==e[0])return!0;if(":"==e[1]&&"\\"==e[2])return!0;if("\\\\"==e.substring(0,2))return!0},exports.flatten=function(e,t){t=t||[];var n=e.length;for(var r=0;r<n;++r)Array.isArray(e[r])?exports.flatten(e[r],t):t.push(e[r]);return t},exports.normalizeType=function(e){return~e.indexOf("/")?acceptParams(e):{value:mime.lookup(e),params:{}}},exports.normalizeTypes=function(e){var t=[];for(var n=0;n<e.length;++n)t.push(exports.normalizeType(e[n]));return t},exports.contentDisposition=deprecate.function(contentDisposition,"utils.contentDisposition: use content-disposition npm module instead"),exports.compileETag=function(e){var t;if(typeof e=="function")return e;switch(e){case!0:t=exports.wetag;break;case!1:break;case"strong":t=exports.etag;break;case"weak":t=exports.wetag;break;default:throw new TypeError("unknown value for etag function: "+e)}return t},exports.compileQueryParser=function(t){var n;if(typeof t=="function")return t;switch(t){case!0:n=querystring.parse;break;case!1:n=newObject;break;case"extended":n=qs.parse;break;case"simple":n=querystring.parse;break;default:throw new TypeError("unknown value for query parser function: "+t)}return n},exports.compileTrust=function(e){return typeof e=="function"?e:e===!0?function(){return!0}:typeof e=="number"?function(t,n){return n<e}:(typeof e=="string"&&(e=e.split(/ *, */)),proxyaddr.compile(e||[]))},exports.setCharset=function(e,t){if(!e||!t)return e;var n=typer.parse(e);return n.parameters.charset=t,typer.format(n)};