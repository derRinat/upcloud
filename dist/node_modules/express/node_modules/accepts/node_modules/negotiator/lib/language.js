function parseAcceptLanguage(e){return e.split(",").map(function(e,t){return parseLanguage(e.trim(),t)}).filter(function(e){return e})}function parseLanguage(e,t){var n=e.match(/^\s*(\S+?)(?:-(\S+?))?\s*(?:;(.*))?$/);if(!n)return null;var r=n[1],i=n[2],s=r;i&&(s+="-"+i);var o=1;if(n[3]){var u=n[3].split(";");for(var t=0;t<u.length;t++){var a=u[t].split("=");a[0]==="q"&&(o=parseFloat(a[1]))}}return{prefix:r,suffix:i,q:o,i:t,full:s}}function getLanguagePriority(e,t){return t.map(function(t){return specify(e,t)}).filter(Boolean).sort(function(e,t){return e.s==t.s?e.q>t.q?-1:1:e.s>t.s?-1:1})[0]||{s:0,q:0}}function specify(e,t){var n=parseLanguage(e);if(!n)return null;var r=0;if(t.full.toLowerCase()===n.full.toLowerCase())r|=4;else if(t.prefix.toLowerCase()===n.full.toLowerCase())r|=2;else if(t.full.toLowerCase()===n.prefix.toLowerCase())r|=1;else if(t.full!=="*")return null;return{s:r,q:t.q}}function preferredLanguages(e,t){e=parseAcceptLanguage(e===undefined?"*":e||"");if(t){var n=t.map(function(t){return[t,getLanguagePriority(t,e)]}).filter(function(e){return e[1].q>0}).sort(function(e,t){var n=e[1],r=t[1];return r.q-n.q||r.s-n.s||n.i-r.i}).map(function(e){return e[0]});return n}return e.sort(function(e,t){return t.q-e.q||e.i-t.i}).filter(function(e){return e.q>0}).map(function(e){return e.full})}module.exports=preferredLanguages,preferredLanguages.preferredLanguages=preferredLanguages;